@using MudBlazor
@using CaloriesCatcher.UI.Service.IService
@using KitchenComfort.Web.Models

<MudDialog>
    <DialogContent>
            <MudSelect T="string"  @bind-Value="SelectedSubscription">
                <MudSelectItem Value="@Turtle">Turtle</MudSelectItem>
                <MudSelectItem Value="@Elephant">Elephant ($9.99)</MudSelectItem>
                <MudSelectItem Value="@Parrots">Parrot ($29.99)</MudSelectItem>
                <MudSelectItem Value="@Cat">Cat (Beta Tester)</MudSelectItem>
            </MudSelect>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="CloseDialog" Color="Color.Default" Variant="Variant.Outlined" Size="Size.Small">Cancel</MudButton>
        <MudButton OnClick="ConfirmSubscription" Color="Color.Primary" Size="Size.Small" Class="ml-3">Confirm</MudButton>
    </DialogActions>
</MudDialog>

@code {
    public string Turtle { get; set; } = "Turtle";
    public string Elephant { get; set; } = "Elephant";
    public string Parrots { get; set; } = "Parrot";
    public string Cat { get; set; } = "Cat";
    [Parameter] public string userEmail { get; set; }
    [Inject] public IAuthService _authService { get; set; }
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    string SelectedSubscription = "Turtle"; // Default selected value

    void CloseDialog() => MudDialog.Cancel();

    void ConfirmSubscription()
    {
        var result = _authService.AssignRoleAsync(new RegisterationRequestDto()
        {
            Email = userEmail,
            RoleName = SelectedSubscription,
            Password = "",
            PhoneNumber = "",
            UserName = ""
        });
        MudDialog.Close(DialogResult.Ok(SelectedSubscription));
    }
}