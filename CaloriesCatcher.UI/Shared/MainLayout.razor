@inherits LayoutComponentBase
<MudThemeProvider @ref="@_mudThemeProvider" @bind-IsDarkMode="@_isDarkMode" />
<MudDialogProvider />
<MudSnackbarProvider />
<PageTitle>Calories Catcher</PageTitle>

<MudLayout>
    <MudAppBar Elevation="1">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@((e) => DrawerToggle())" />
        <MudSpacer />
        <MudIconButton Icon="@Icons.Material.Filled.Brightness6" Color="Color.Inherit" Edge="Edge.End" OnClick="@ToggleTheme" />
        <MudIconButton Icon="@Icons.Material.Filled.MoreVert" Color="Color.Inherit" Edge="Edge.End" />
    </MudAppBar>
    <MudDrawer @bind-Open="_drawerOpen" Elevation="2">
        <MudDrawerHeader>
            <MudText Typo="Typo.h5" Class="mt-1">Dashboard</MudText>
        </MudDrawerHeader>
        <NavMenu></NavMenu>
    </MudDrawer>
    <MudMainContent>
        @Body
    </MudMainContent>
</MudLayout>

@code {
    bool _drawerOpen = true;
    bool _isDarkMode = false;  // By default, set to light mode
    private MudThemeProvider _mudThemeProvider;
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            _isDarkMode = await _mudThemeProvider.GetSystemPreference();
            StateHasChanged();
        }
    }
    MudBlazor.MudTheme _lightTheme = new MudBlazor.MudTheme
        {
            Palette = new MudBlazor.Palette
            {
                Black = "#ffffff",
                Background = "#f5f5f5",
                AppbarBackground = "#483659",
                DrawerBackground = "#483659",
                DrawerText = "#ffffff",
                DrawerIcon = "#ffffff"
            }

        };

    MudBlazor.MudTheme _darkTheme = new MudBlazor.MudTheme
        {
            Palette = new MudBlazor.Palette
            {
                Black = "#ffffff",
                Background = "#1e1e2d",
                AppbarBackground = "#7e6fff",
                DrawerBackground = "#1e1e2d",
                DrawerText = "#ffffff",
                DrawerIcon = "#ffffff"
            }
        };

    void DrawerToggle()
    {
        _drawerOpen = !_drawerOpen;
    }

    void ToggleTheme()
    {
        _isDarkMode = !_isDarkMode;
    }
}
